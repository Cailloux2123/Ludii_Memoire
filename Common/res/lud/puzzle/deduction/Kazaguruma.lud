(game "Kazaguruma" 
    (players 1) 
    (equipment { 
        (board 
            (merge {
                (square 9) 
                (shift 6 3 (square 9)) 
                (shift 3 9 (square 9)) 
                (shift 12 6 (square 9)) 
                (shift 9 -3 (square 9)) 
            })
            (values Cell (range 1 9))
        ) 
        
     // Sudoku W
        // Row
        (regions {0 1 2 3 4 5 6 7 8})
        (regions {11 12 13 14 15 16 17 18 19})
        (regions {21 22 23 24 25 26 27 28 29})
        (regions {31 32 33 34 35 36 37 38 39})
        (regions {41 42 43 44 45 46 47 48 49})
        (regions {51 52 53 54 55 56 57 58 59})
        (regions {61 62 63 64 65 66 67 68 69})
        (regions {71 72 73 74 75 76 77 78 79})
        (regions {81 82 83 84 85 86 87 88 89})
        // Column
        (regions {0 11 21 31 41 51 61 71 81})
        (regions {1 12 22 32 42 52 62 72 82})
        (regions {2 13 23 33 43 53 63 73 83})
        (regions {3 14 24 34 44 54 64 74 84})
        (regions {4 15 25 35 45 55 65 75 85})
        (regions {5 16 26 36 46 56 66 76 86})
        (regions {6 17 27 37 47 57 67 77 87})
        (regions {7 18 28 38 48 58 68 78 88})
        (regions {8 19 29 39 49 59 69 79 89})
        // Subgrid
        (regions {0 1 2 11 12 13 21 22 23})
        (regions {3 4 5 14 15 16 24 25 26})
        (regions {6 7 8 17 18 19 27 28 29})
        (regions {31 32 33 41 42 43 51 52 53})
        (regions {34 35 36 44 45 46 54 55 56})
        (regions {37 38 39 47 48 49 57 58 59})
        (regions {61 62 63 71 72 73 81 82 83})
        (regions {64 65 66 74 75 76 84 85 86})
        (regions {67 68 69 77 78 79 87 88 89})
        
     // Sudoku N
        // Row
        (regions {91 92 93 94 95 96 97 140 141})
        (regions {179 180 147 146 148 149 150 151 152})
        (regions {181 182 158 157 159 160 161 162 163})
        (regions {183 184 169 168 170 171 172 173 174})
        (regions {185 186 187 188 189 190 191 192 193})
        (regions {195 196 197 198 199 200 201 202 203})
        (regions {205 206 207 208 209 210 211 212 213})
        (regions {214 215 216 217 218 219 220 221 222})
        (regions {223 224 225 226 227 228 229 230 231})
        // Column
        (regions {91 179 181 183 185 195 205 214 223})
        (regions {92 180 182 184 186 196 206 215 224})
        (regions {93 147 158 169 187 197 207 216 225})
        (regions {94 146 157 168 188 198 208 217 226})
        (regions {95 148 159 170 189 199 209 218 227})
        (regions {96 149 160 171 190 200 210 219 228})
        (regions {97 150 161 172 191 201 211 220 229})
        (regions {140 151 162 173 192 202 212 221 230})
        (regions {141 152 163 174 193 203 213 222 231})
        // Subgrid
        (regions {91 92 93 179 180 147 181 182 158})
        (regions {94 95 96 146 148 149 157 159 160})
        (regions {97 140 141 150 151 152 161 162 163})
        (regions {183 184 169 185 186 187 195 196 197})
        (regions {168 170 171 188 189 190 198 199 200})
        (regions {172 173 174 191 192 193 201 202 203})
        (regions {205 206 207 214 215 216 223 224 225})
        (regions {208 209 210 217 218 219 226 227 228})
        (regions {211 212 213 220 221 222 229 230 231})
        
     // Sudoku S
        // Row
        (regions {285 286 287 288 289 290 291 292 293})
        (regions {294 295 296 297 298 299 300 301 302})
        (regions {9 303 304 305 306 307 308 309 310})
        (regions {10 311 312 313 314 315 316 317 318})
        (regions {20 319 320 321 322 323 324 325 326})
        (regions {30 98 100 102 104 106 108 327 328})
        (regions {40 99 101 103 105 107 109 329 330})
        (regions {50 110 111 112 113 114 115 331 332})
        (regions {60 116 117 118 119 120 121 232 234})
        // Column
        (regions {285 294 9 10 20 30 40 50 60})
        (regions {286 295 303 311 319 98 99 110 116})
        (regions {287 296 304 312 320 100 101 111 117})
        (regions {288 297 305 313 321 102 103 112 118})
        (regions {289 298 306 314 322 104 105 113 119})
        (regions {290 299 307 315 323 106 107 114 120})
        (regions {291 300 308 316 324 108 109 115 121})
        (regions {292 301 309 317 325 327 329 331 232})
        (regions {293 302 310 318 326 328 330 332 234})
        // Subgrid
        (regions {285 286 287 294 295 296 9 303 304})
        (regions {288 289 290 297 298 299 305 306 307})
        (regions {291 292 293 300 301 302 308 309 310})
        (regions {10 311 312 20 319 320 100 98 30})
        (regions {313 314 315 321 322 323 102 104 106})
        (regions {316 317 318 324 325 326 108 327 328})
        (regions {40 99 101 50 110 111 60 116 117})
        (regions {103 105 107 112 113 114 118 119 120})
        (regions {109 329 330 115 331 332 121 232 234})
        
     // Sudoku E
        // Row
        (regions {124 125 126 127 233 235 236 237 238})
        (regions {130 131 132 133 239 240 241 242 243})
        (regions {136 137 138 139 244 245 246 247 248})
        (regions {142 143 144 145 249 250 251 252 253})
        (regions {153 154 155 156 254 255 256 257 258})
        (regions {164 165 166 167 259 260 261 262 263})
        (regions {175 176 177 178 264 265 266 267 268})
        (regions {194 269 270 271 272 273 274 275 276})
        (regions {204 277 278 279 280 281 282 283 284})
        // Column
        (regions {124 130 136 142 153 164 175 194 204})
        (regions {125 131 137 143 154 165 176 269 277})
        (regions {126 132 138 144 155 166 177 270 278})
        (regions {127 133 139 145 156 167 178 271 279})
        (regions {233 239 244 249 254 259 264 272 280})
        (regions {235 240 245 250 255 260 265 273 281})
        (regions {236 241 246 251 256 261 266 274 282})
        (regions {237 242 247 252 257 262 267 275 283})
        (regions {238 243 248 253 258 263 268 276 284})
        // Subgrid
        (regions {124 125 126 130 131 132 136 137 138})
        (regions {127 233 235 133 239 240 139 244 245})
        (regions {236 237 238 241 242 243 246 247 248})
        (regions {142 143 144 153 154 155 164 165 166})
        (regions {145 249 250 156 254 255 167 259 260})
        (regions {251 252 253 256 257 258 261 262 263})
        (regions {175 176 177 194 269 270 204 277 278})
        (regions {178 264 265 271 272 273 279 280 281})
        (regions {266 267 268 274 275 276 282 283 284})
        
     // Sudoku Center
        // Row
        (regions {37 38 39 40 99 101 103 105 107})
        (regions {47 48 49 50 110 111 112 113 114})
        (regions {57 58 59 60 116 117 118 119 120})
        (regions {67 68 69 70 122 123 124 125 126})
        (regions {77 78 79 80 128 129 130 131 132})
        (regions {87 88 89 90 134 135 136 137 138})
        (regions {94 95 96 97 140 141 142 143 144})
        (regions {146 148 149 150 151 152 153 154 155})
        (regions {157 159 160 161 162 163 164 165 166})
        // Column
        (regions {37 47 57 67 77 87 94 146 157})
        (regions {38 48 58 68 78 88 95 148 159})
        (regions {39 49 59 69 79 89 96 149 160})
        (regions {40 50 60 70 80 90 97 150 161})
        (regions {99 110 116 122 128 134 140 151 162})
        (regions {101 111 117 123 129 135 141 152 163})
        (regions {103 112 118 124 130 136 142 153 164})
        (regions {105 113 119 125 131 137 143 154 165})
        (regions {107 114 120 126 132 138 144 155 166})
        // Subgrid
        (regions {70 122 123 80 128 129 90 134 135})

    }) 
    (rules
    	(start <Challenge>)
        (play (satisfy (all Different)))
        (end (if (is Solved) (result P1 Win)))
    )
)

//------------------------------------------------------------------------------

(option "Challenge" <Challenge> args:{ <start> }
{
(item "1" 
    <(set { 
    	{288 7} {289 1} {294 8} {296 3} {299 2} {301 7} {302 1} {9 7} {303 1} {308 5} {1 5} {3 2} {4 1} {5 3} {7 6} {312 9} {313 3} {315 1}
    	{317 4} {12 3} {14 7} {319 3} {322 9} {326 2} {23 1} {28 5} {98 2} {102 8} {106 6} {328 3} {32 1} {34 6} {36 2} {37 5} {101 1} {107 9}
    	{41 7} {45 5} {48 3} {110 8} {113 4} {115 3} {332 9} {51 6} {54 4} {56 7} {59 1} {118 6} {62 8} {64 3} {67 7} {236 5} {237 4} {73 4} {75 7}
    	{76 9} {78 8} {131 9} {133 1} {239 8} {241 6} {82 7} {83 3} {138 7} {245 4} {247 3} {96 9} {142 7} {145 2} {250 5} {253 9} {179 2} {147 5}
    	{148 6} {151 7} {154 5} {254 1} {258 3} {157 2} {161 8} {166 6} {167 3} {260 8} {262 2} {183 9} {168 6} {171 4} {173 8} {176 8} {266 2}
    	{185 8} {189 7} {192 9} {273 6} {275 1} {195 1} {196 2} {198 8} {200 3} {201 4} {277 4} {279 7} {280 5} {283 9} {207 9} {212 4} {213 5}
    	{214 5} {215 6} {217 9} {219 2} {220 7} {222 8} {227 8} {228 5}
    })> 
    ""
) 
})

//------------------------------------------------------------------------------

(metadata 
    (info
        {
        (description "Kazaguruma is one of the sudoku variation with overlapping sudoku grids.")
        (rules "The puzzle consists of five grids, one in the center and the other 4 overlapping a side of the grid. This means that the numbers must be different  for all the five puzzle squares like as 5 different Sudoku.")
        (source "<a href=\"https://www.cross-plus-a.com/fr/sudoku.htm#Kazaguruma\" target=\"_blank\" class=\"style1\" style=\"color: #0000EE\" />cross-plus-a.com</a>")
        (version "1.3.12")
        (classification "puzzle/deduction")
        (credit "Pierre Accou")
        }
    )
    
    (graphics {
        (show Line {
        	{0 348} {30 369} {60 246} {90 264} {178 282} {201 309} {231 240} {310 319}
            {0 90} {3 231} {6 234} {310 237} {313 240} {316 303} {319 306} {246 309}
            } 
            (colour Black) scale:2
        )
        (region Colour {37 38 39 40 99 101 103 105 107 47 48 49 50 110 111 112 113 114 57 58 59 60 116 117 118 119 120 67 68 69 70 122 123 124 125 126
        	77 78 79 80 128 129 130 131 132 87 88 89 90 134 135 136 137 138 94 95 96 97 140 141 142 143 144 146 148 149 150 151 152 153 154 155 157 159 
        	160 161 162 163 164 165 166} (colour 228 204 188))
    })
)
