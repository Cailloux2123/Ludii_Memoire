(game "Butterfly Sudoku" 
    (players 1) 
    (equipment { 
        (board (square 12) (values Cell (range 1 9))) 
        //Sudoku SE
        // Rows
        (regions {0 1 2 3 4 5 6 7 8})
        (regions {12 13 14 15 16 17 18 19 20})
        (regions {24 25 26 27 28 29 30 31 32})
        (regions {36 37 38 39 40 41 42 43 44})
        (regions {48 49 50 51 52 53 54 55 56})
        (regions {60 61 62 63 64 65 66 67 68})
        (regions {72 73 74 75 76 77 78 79 80})
        (regions {84 85 86 87 88 89 90 91 92})
        (regions {96 97 98 99 100 101 102 103 104})
        
        // Column
        (regions {0 12 24 36 48 60 72 84 96})
        (regions {1 13 25 37 49 61 73 85 97})
        (regions {2 14 26 38 50 62 74 86 98})
        (regions {3 15 27 39 51 63 75 87 99})
        (regions {4 16 28 40 52 64 76 88 100})
        (regions {5 17 29 41 53 65 77 89 101})
        (regions {6 18 30 42 54 66 78 90 102})
        (regions {7 19 31 43 55 67 79 91 103})
        (regions {8 20 32 44 56 68 80 92 104})
        
        // Subgrid
        (regions {0 1 2 12 13 14 24 25 26})
        (regions {3 4 5 15 16 17 27 28 29})
        (regions {6 7 8 18 19 20 30 31 32})
        (regions {36 37 38 48 49 50 60 61 62})
        (regions {39 40 41 51 52 53 63 64 65})
        (regions {42 43 44 54 55 56 66 67 68})
        (regions {72 73 74 84 85 86 96 97 98})
        (regions {75 76 77 87 88 89 99 100 101})
        (regions {78 79 80 90 91 92 102 103 104})
        
        //Sudoku SW
        // Rows
        (regions {3 4 5 6 7 8 9 10 11})
        (regions {15 16 17 18 19 20 21 22 23})
        (regions {27 28 29 30 31 32 33 34 35})
        (regions {39 40 41 42 43 44 45 46 47})
        (regions {51 52 53 54 55 56 57 58 59})
        (regions {63 64 65 66 67 68 69 70 71})
        (regions {75 76 77 78 79 80 81 82 83})
        (regions {87 88 89 90 91 92 93 94 95})
        (regions {99 100 101 102 103 104 105 106 107})
        
        // Column
        (regions {3 15 27 39 51 63 75 87 99})
        (regions {4 16 28 40 52 64 76 88 100})
        (regions {5 17 29 41 53 65 77 89 101})
        (regions {6 18 30 42 54 66 78 90 102})
        (regions {7 19 31 43 55 67 79 91 103})
        (regions {8 20 32 44 56 68 80 92 104})
        (regions {9 21 33 45 57 69 81 93 105})
        (regions {10 22 34 46 58 70 82 94 106})
        (regions {11 23 35 47 59 71 83 95 107})
        
        // Subgrid
        (regions {9 10 11 21 22 23 33 34 35})
        (regions {45 46 47 57 58 59 69 70 71})
        (regions {81 82 83 93 94 95 105 106 107})
        
        //Sudoku NE
        // Rows
        (regions {36 37 38 39 40 41 42 43 44})
        (regions {48 49 50 51 52 53 54 55 56})
        (regions {60 61 62 63 64 65 66 67 68})
        (regions {72 73 74 75 76 77 78 79 80})
        (regions {84 85 86 87 88 89 90 91 92})
        (regions {96 97 98 99 100 101 102 103 104})
        (regions {108 109 110 111 112 113 114 115 116})
        (regions {120 121 122 123 124 125 126 127 128})
        (regions {132 133 134 135 136 137 138 139 140})
        
        // Column
        (regions {36 48 60 72 84 96 108 120 132})
        (regions {37 49 61 73 85 97 109 121 133})
        (regions {38 50 62 74 86 98 110 122 134})
        (regions {39 51 63 75 87 99 111 123 135})
        (regions {40 52 64 76 88 100 112 124 136})
        (regions {41 53 65 77 89 101 113 125 137})
        (regions {42 54 66 78 90 102 114 126 138})
        (regions {43 55 67 79 91 103 115 127 139})
        (regions {44 56 68 80 92 104 116 128 140})
        
        // Subgrid
        (regions {108 109 110 120 121 122 132 133 134})
        (regions {111 112 113 123 124 125 135 136 137})
        (regions {114 115 116 126 127 128 138 139 140})
        
        //Sudoku NW
        // Rows
        (regions {39 40 41 42 43 44 45 46 47})
        (regions {51 52 53 54 55 56 57 58 59})
        (regions {63 64 65 66 67 68 69 70 71})
        (regions {75 76 77 78 79 80 81 82 83})
        (regions {87 88 89 90 91 92 93 94 95})
        (regions {99 100 101 102 103 104 105 106 107})
        (regions {111 112 113 114 115 116 117 118 119})
        (regions {123 124 125 126 127 128 129 130 131})
        (regions {135 136 137 138 139 140 141 142 143})
        
        // Column
        (regions {39 51 63 75 87 99 111 123 135})
        (regions {40 52 64 76 88 100 112 124 136})
        (regions {41 53 65 77 89 101 113 125 137})
        (regions {42 54 66 78 90 102 114 126 138})
        (regions {43 55 67 79 91 103 115 127 139})
        (regions {44 56 68 80 92 104 116 128 140})
        (regions {45 57 69 81 93 105 117 129 141})
        (regions {46 58 70 82 94 106 118 130 142})
        (regions {47 59 71 83 95 107 119 131 143})
        
        // Subgrid
        (regions {117 118 119 129 130 131 141 142 143})
        
    }) 
    (rules
        (start <Challenge>)
        (play (satisfy (all Different)))
        (end (if (is Solved) (result P1 Win)))
    )
)

//------------------------------------------------------------------------------

(option "Challenge" <Challenge> args:{ <start> }
    {
    (item "1" 
        <(set { 
        	{ 133 9 } {142 7} {120 5} {122 4} {124 8} {127 1} {129 3} {131 5} {109 2} 
        	{112 1} {113 3} {114 5} {115 7} {118 2} {99 4} {101 6} {102 1} {104 9} 
        	{85 1} {86 2} {93 4} {94 1} {74 6} {75 2} {77 1} {78 8} {80 7} {81 5} 
        	{62 9} {63 1} {65 4} {66 7} {68 8} {69 9} {49 4} {50 5} {57 7} {58 5} 
        	{39 5} {41 9} {42 4} {44 3} {25 9} {28 8} {29 5} {30 3} {31 1} {34 4} 
        	{12 1} {14 8} {16 4} {19 7} {21 1} {23 8} {1 3} {10 7}
        })>
        ""
    ) 
})

//------------------------------------------------------------------------------

(metadata 
    (info
        {
        (description "Butterfly Sudoku is one of the sudoku variation with overlapping sudoku grids.")
        (rules "The puzzle consists of four grids, N-E N-W S-E S-W. This means that the numbers must be different  for all the four puzzle squares like as 4 different Sudoku.")
        (source "<a href=\"https://www.cross-plus-a.com/fr/sudoku.htm#ButterflySudoku\" target=\"_blank\" class=\"style1\" style=\"color: #0000EE\" />cross-plus-a.com</a>")
        (version "1.3.12")
        (classification "puzzle/deduction")
        (credit "Pierre Accou")
        }
    )
    
    (graphics {
    	(board Style Sudoku)
    	(region Colour {39 40 41 42 43 44 51 52 53 54 55 56 63 64 65 66 67 68 75 76 77 78 79 80 87 88 89 90 91 92 99 100 101 102 103 104} (colour 52 201 36))
    	(region Colour {3 4 5 6 7 8 15 16 17 18 19 20 27 28 29 30 31 32 36 37 38 48 49 50 60 61 62 72 73 74 84 85 86 96 97 98 45 46 47 57 58 59 69 70 71 81 82 83 93 94 95 105 106 107 111 112 113 114 115 116 123 124 125 126 127 128 135 136 137 138 139 140} (colour 255 145 36))
    })
)
